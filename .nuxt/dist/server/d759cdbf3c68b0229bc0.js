exports.ids=[7],exports.modules={26:function(t,e,r){"use strict";e.a={methods:{footer(){$("#mailContent").height()<$(window).height()?this.$store.commit("changeFooterFixed",!0):this.$store.commit("changeFooterFixed",!1)}}}},27:function(t,e,r){"use strict";var n=r(24),l=r.n(n);l.a.interceptors.response.use(t=>t.data?t.data:{},function(t){return Promise.reject(t)});var o=l.a;r.d(e,"f",function(){return c}),r.d(e,"h",function(){return d}),r.d(e,"g",function(){return y}),r.d(e,"d",function(){return m}),r.d(e,"n",function(){return x}),r.d(e,"i",function(){return v}),r.d(e,"a",function(){return f}),r.d(e,"e",function(){return w}),r.d(e,"c",function(){return S}),r.d(e,"m",function(){return L}),r.d(e,"j",function(){return C}),r.d(e,"b",function(){return _}),r.d(e,"l",function(){return B}),r.d(e,"k",function(){return D});const h="production api",c=(t={})=>o.get(`${h}article/get`,{params:t}),d=t=>o.get(`${h}article/get/${t}`),y=()=>o.get(`${h}article/getAll`),m=t=>o.post(`${h}article/like/${t}`),x=()=>o.get(`${h}tag/get`),v=t=>o.get(`${h}comment/get`,{params:t}),f=t=>o.put(`${h}comment/add`,{...t}),w=t=>o.post(`${h}comment/like/${t}`),S=t=>o.put(`${h}reply/add`,{...t}),L=t=>o.get(`${h}reply/get/${t}`),C=t=>o.get(`${h}hero/get`,{params:t}),_=t=>o.put(`${h}hero/add`,{...t}),B=t=>o.get(`${h}project/get`,{params:t}),D=t=>o.get(`${h}music/get`,{params:t})},38:function(t,e){},54:function(t,e,r){"use strict";r.r(e);var n=r(38),l=r.n(n);for(var o in n)"default"!==o&&function(t){r.d(e,t,function(){return n[t]})}(o);e.default=l.a},61:function(t,e,r){"use strict";r.r(e);var n=r(26),l=r(27);function o(t){var e=t.substring(1,t.length).split(":");return parseFloat(60*e[0])+parseFloat(e[1])}var h="#000011",c="#060D1F",d="#02243F",y="#465677",m="#B5BFD4",x="#F451BA",v=1500,f=140,w="rgba(29, 36, 57, 0.05)",S="rgba(0,0,0,0)",L="rgba(157, 242, 157, 0.11)",C="rgba(157, 242, 157, 0.8)",_=.05,B=512,D="rgba(29, 36, 57, 0.1)",M="rgba(29, 36, 57, 0.05)",$="rgba(77, 218, 248, 1)",k="rgba(77, 218, 248, 1)",A=.001,P=64,F=100,N=(Math.floor,Math.round,Math.random),E=Math.sin,T=Math.cos,I=Math.PI,Y=2*I,O=I/180,z=0,j=0,H=0;class W{constructor(t,e,r){let n,l;this.x=Math.random()*e-z,this.y=Math.random()*r-j,this.z=this.max_depth=Math.max(e/r),this.radius=.2,n=this.x>0?1:-1,l=this.y>0?1:-1,Math.abs(this.x)>Math.abs(this.y)?(this.dx=1,this.dy=Math.abs(this.y/this.x)):(this.dx=Math.abs(this.x/this.y),this.dy=1),this.dx*=n,this.dy*=l,this.dz=-.1,this.ddx=.001*this.dx,this.ddy=.001*this.dy,this.y>j/2?this.color=m:this.color=t>F+10?m:t>f?x:y,n=l=null}}class J{constructor(t){this.index=t.index,this.angle=360*this.index/B,this.updateDynamics(t.w,t.h),this.value=256*Math.random(),this.dx=this.x+this.value*E(O*this.angle),this.dy=this.y+this.value*T(O*this.angle)}updateDynamics(t,e){this.radius=Math.abs(t,e)/10,this.x=z+this.radius*E(O*this.angle),this.y=j+this.radius*T(O*this.angle)}}class U{constructor(t){this.index=t.index,this.angle=360*this.index/P,this.updateDynamics(t.w,t.h),this.value=256*Math.random(),this.dx=this.x+this.value*E(O*this.angle),this.dy=this.y+this.value*T(O*this.angle)}updateDynamics(t,e){this.radius=Math.abs(t,e)/10,this.x=z+this.radius*E(O*this.angle),this.y=j+this.radius*T(O*this.angle)}}var G=class{constructor(t,e,r,n,l){this.analyser=e,this.ctx=t,this.stars=[],this.points=[],this.avg_points=[],this.w=r,this.h=n,this.playing=!1,this.frequencyDataLength=e.frequencyBinCount,this.frequencyData=new Uint8Array(this.frequencyDataLength),this.timeData=new Uint8Array(this.frequencyDataLength),this.cb=l,this.init()}init(){this.resizeHandler(),this.createStarField(),this.createPoints(),this.clearCanvas(),this.drawStarField(),this.drawAverageCircle(),this.drawWaveform()}updatePlaying(b){this.playing=b}createStarField(){let i=-1;for(;++i<v;)this.stars.push(new W(this.avg,this.w,this.h));this.catchOriginStart=JSON.parse(JSON.stringify(this.stars)),i=null}createPoints(){const{w:t,h:e}=this;let i=-1;for(;++i<B;)this.points.push(new J({index:i+1,w:t,h:e}));for(i=-1;++i<P;)this.avg_points.push(new U({index:i+1,w:t,h:e}));i=null}getAvg(t){let e=0;return t.forEach(t=>{e+=t}),e/t.length}animate(){if(!this.playing)return;const{analyser:t,getAvg:e,frequencyData:r,timeData:n}=this;requestAnimationFrame(this.animate.bind(this)),t.getByteFrequencyData(r),t.getByteTimeDomainData(n),this.avg=e([].slice.call(r)),this.clearCanvas(),this.drawStarField(),this.drawAverageCircle(),this.drawWaveform(),this.cb&&this.cb()}clearCanvas(){const{ctx:t,w:e,h:r}=this;let n=t.createLinearGradient(0,0,0,r);n.addColorStop(0,h),n.addColorStop(.96,c),n.addColorStop(1,d),t.beginPath(),t.globalCompositeOperation="source-over",t.fillStyle=n,t.fillRect(0,0,e,r),t.fill(),t.closePath(),n=null}drawStarField(){let i,t,p,e,{stars:r,avg:n,ctx:l,catchOriginStart:o}=this,h=this.w,c=this.h;for(i=0,t=r.length;i<t;i++)(p=r[i]).x=p.x||o[i].x,p.y=p.y||o[i].y,e=n>F?n/20:n/50,p.x+=p.dx*e,p.y+=p.dy*e,p.z+=p.dz,p.dx+=p.ddx,p.dy+=p.ddy,p.radius=.2+.1*(p.max_depth-p.z),p.x<-z||p.x>z||p.y<-j||p.y>j?r[i]=new W(n,h,c):(l.beginPath(),l.globalCompositeOperation="lighter",l.fillStyle=p.color,l.arc(p.x+z,p.y+j,p.radius,Y,!1),l.fill(),l.closePath());i=t=p=e=null}drawAverageCircle(){let i,t,p,e,r,n,{avg:l,ctx:o,avg_points:h}=this;for(l>F?(H+=-A,e=l+10*N(),o.strokeStyle=k,o.fillStyle=M):(H+=A,e=l,o.strokeStyle=$,o.fillStyle=D),o.beginPath(),o.lineWidth=1,o.lineCap="round",o.save(),o.translate(z,j),o.rotate(H),o.translate(-z,-j),o.moveTo(h[0].dx,h[0].dy),i=0,t=P;i<t-1;i++)(p=h[i]).dx=p.x+e*E(O*p.angle),p.dy=p.y+e*T(O*p.angle),r=(p.dx+h[i+1].dx)/2,n=(p.dy+h[i+1].dy)/2,o.quadraticCurveTo(p.dx,p.dy,r,n);(p=h[i]).dx=p.x+e*E(O*p.angle),p.dy=p.y+e*T(O*p.angle),r=(p.dx+h[0].dx)/2,n=(p.dy+h[0].dy)/2,o.quadraticCurveTo(p.dx,p.dy,r,n),o.quadraticCurveTo(r,n,h[0].dx,h[0].dy),o.stroke(),o.fill(),o.restore(),o.closePath(),i=t=p=e=r=n=null}drawWaveform(){let i,t,p,e,r,n,{avg:l,ctx:o,points:h,timeData:c}=this;for(l>F?(H+=_,o.strokeStyle=C,o.fillStyle=S):(H+=-_,o.strokeStyle=L,o.fillStyle=w),o.beginPath(),o.lineWidth=1,o.lineCap="round",o.save(),o.translate(z,j),o.rotate(H),o.translate(-z,-j),o.moveTo(h[0].dx,h[0].dy),i=0,t=B;i<t-1;i++)p=h[i],e=c[i],p.dx=p.x+e*E(O*p.angle),p.dy=p.y+e*T(O*p.angle),r=(p.dx+h[i+1].dx)/2,n=(p.dy+h[i+1].dy)/2,o.quadraticCurveTo(p.dx,p.dy,r,n);e=c[i],(p=h[i]).dx=p.x+e*E(O*p.angle),p.dy=p.y+e*T(O*p.angle),r=(p.dx+h[0].dx)/2,n=(p.dy+h[0].dy)/2,o.quadraticCurveTo(p.dx,p.dy,r,n),o.quadraticCurveTo(r,n,h[0].dx,h[0].dy),o.stroke(),o.fill(),o.restore(),o.closePath(),i=t=p=e=r=n=null}resizeHandler(){let{ctx:t,w:e,h:r,avg_points:n,points:l}=this;z=e/2,j=r/2,t.canvas.width=e,t.canvas.height=r,l.forEach(p=>{p.updateDynamics()}),n.forEach(p=>{p.updateDynamics()})}},R={head:{title:"naice | 音乐",meta:[{hid:"description",name:"description",content:"naice | 音乐"}]},layout:"music-layout",data:()=>({music:[],lyricArr:[],playing:!1,musicLink:"",text1:"",text2:"",playIndex:0,showLyric:!1,poster:"",showAllBtn:!1,showlyricScroll:!1,lyricScrollY:0,isScrolling:!1,showList:!1}),mixins:[n.a],computed:{showBtns(){return!this.showLyric}},methods:{initDom(){const t=this.$refs;this.play=t.play,this.pause=t.pause,this.next=t.next,this.prev=t.prev,this.canvas=t.canvas,this.audio=t.audio,this.musicBox=t.musicBox,this.lyriList=t.lyriList,this.lyricScrollBar=t.lyricScrollBar,this.musicList=t.musicList,this.musicListBox=t.musicListBox,this.init(),this.initCanvas(),this.initLyricScroll()},init(){this.ctx=this.canvas.getContext("2d"),this.audioCtx=new(window.AudioContext||window.webkitAudioContext),this.source=this.audioCtx.createMediaElementSource(this.audio),this.analyser=this.audioCtx.createAnalyser(),this.analyser.fftSize=1024,this.analyser.minDecibels=-100,this.analyser.maxDecibels=-30,this.analyser.smoothingTimeConstant=.8,this.analyser.connect(this.audioCtx.destination),this.source.connect(this.analyser)},initCanvas(){const{ctx:t,analyser:e,musicBox:r,canvas:canvas}=this;let n=r.offsetWidth,l=r.offsetHeight;canvas.width=n,canvas.height=l,canvas.style.width=n+"px",canvas.style.height=l+"px",this.musicDraw=new G(t,e,n,l,this.getLineLyric),this.audio.onended=(()=>{this.toNext()}),this.poster=this.music[0]?this.music[0].poster:""},toPlay(){this.playing?this.toPause():this.musicLink?this.audioCtx.resume().then(()=>{this.audio.play(),this.playing=!0,this.musicDraw.updatePlaying(this.playing),this.musicDraw.animate()}):this.loadMusic()},toPause(){this.audio.pause(),this.playing=!1,this.musicDraw.updatePlaying(this.playing)},toNext(){this.playIndex+=1,this.playIndex===this.music.length&&(this.playIndex=0),this.loadMusic()},toPrev(){this.playIndex-=1,this.playIndex<=0&&(this.playIndex=0),this.loadMusic()},selectMusic(t){this.playIndex=t,this.loadMusic(),this.showList=!1},btnMousrenter(){this.showAllBtn=!0},btnMouseleave(){this.showAllBtn=!1},loadMusic(){let t=this.music[this.playIndex];this.musicLink!==t.url&&(this.toPause(),this.musicLink=t.url,this.poster=t.poster,this.lyricArr=(t=>{let e=[];return t&&(e=t.split("[").reduce((t,e)=>{let r=e.trim().split("]");return r[1]&&t.push({time:o(r[0]),text:r[1]}),t},[])),e})(t.lyrics),this.audio.onloadedmetadata=(()=>{this.toPlay()}))},toList(){this.showList=!this.showList},toLyric(){this.showLyric=!0},hideLyric(){this.showLyric=!1},getLineLyric(){const{audio:audio,lyricArr:t,lyriList:e}=this;let r=((time,t)=>{let e=t.length-1;for(let i=0;i<e;i++)if(time<=t[i].time)return i;return e})(audio.currentTime,t);r>0&&(r-=1),this.text2=t[r].text,this.text1!==this.text2&&(e.style.transform=`translate3d(0, ${32*-r}px,0)`),this.text1=this.text2},initLyricScroll(){const{music:t,lyricScrollBar:e}=this;this.ah=41*t.length,0===this.ah?this.showlyricScroll=!1:this.ah>400&&(this.lyricScrollBarHeight=16e4/this.ah,e.style.height=this.lyricScrollBarHeight+"px",this.showlyricScroll=!0,this.initLyricScrollEvernt())},initLyricScrollEvernt(){const{lyricScrollBar:t,musicListBox:e}=this;let r=0,n=400-this.lyricScrollBarHeight,l=0,o=0;const h=()=>{o<=0?(o=0,l++):o>n?(o=n,l++):l=0,l<=2&&(this.lyricScrollBar.style.transform=`translateY(${o}px)`,this.musicList.style.transform=`translateY(${-o/400*this.ah}px)`)},c=t=>{let e=t.clientY-r;o=this.lyricScrollY+e,this.isScrolling=!0,h()},d=t=>{this.lyricScrollY=o,this.isScrolling=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",d)};t.addEventListener("mousedown",t=>{r=t.clientY,this.isScrolling=!1,document.addEventListener("mousemove",c),document.addEventListener("mouseup",d)}),e.addEventListener("mousewheel",t=>{t.preventDefault(),t.stopPropagation(),o=this.lyricScrollY+t.deltaY,h(),this.lyricScrollY=o})}},async mounted(){let t=await Object(l.k)();this.music=t.result||[],this.$nextTick(()=>{this.initDom(),this.footer()})},beforeDestroy(){this.ctx=null,this.audioCtx=null,this.source=null,this.analyser=null}},K=r(1);var component=Object(K.a)(R,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"musicBox",staticClass:"musicBox"},[t._ssrNode('<div class="oparations" data-v-3ad53f66>',"</div>",[t._ssrNode('<div class="lyricBox abs"'+t._ssrStyle(null,null,{display:t.showLyric?"":"none"})+' data-v-3ad53f66><div class="topMask" data-v-3ad53f66></div> <div class="bottomMask" data-v-3ad53f66></div> <div class="lyriList" data-v-3ad53f66><ul data-v-3ad53f66>'+t._ssrList(t.lyricArr,function(e,r){return"<li data-v-3ad53f66>"+t._ssrEscape(t._s(e.text))+"</li>"})+" "+(0===t.lyricArr.length?"<li data-v-3ad53f66>大侠，请点击播放加载歌词吧...</li>":"\x3c!----\x3e")+"</ul></div></div> "),t._ssrNode('<div class="musicBtnBox abs"'+t._ssrStyle(null,null,{display:t.showBtns?"":"none"})+" data-v-3ad53f66>","</div>",[r("transition",{attrs:{name:"slide-fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.showAllBtn,expression:"showAllBtn"}],staticClass:"musicBtns"},[r("span",{staticClass:"btnList pbtn",on:{click:t.toList}},[r("i",{staticClass:"iconfont"},[t._v("")])]),t._v(" "),r("span",{staticClass:"btnLyric pbtn",on:{click:t.toLyric}},[r("i",{staticClass:"iconfont"},[t._v("")])]),t._v(" "),r("span",{ref:"play",staticClass:"btnPlay pbtn",on:{click:t.toPlay}},[r("i",{staticClass:"iconfont"},[t._v(t._s(t.playing?"":""))])]),t._v(" "),r("span",{ref:"prev",staticClass:"btnPrev pbtn",on:{click:t.toPrev}},[r("i",{staticClass:"iconfont"},[t._v("")])]),t._v(" "),r("span",{ref:"next",staticClass:"btnNext pbtn",on:{click:t.toNext}},[r("i",{staticClass:"iconfont"},[t._v("")])])])]),t._ssrNode(" "),r("transition",{attrs:{name:"poster-fade"}},[t.poster?r("img",{directives:[{name:"show",rawName:"v-show",value:!t.showAllBtn,expression:"!showAllBtn"}],attrs:{src:t.poster}}):t._e()])],2)],2),t._ssrNode(' <canvas width="1000" height="800" class="musicCanvas" data-v-3ad53f66>您的浏览器不支持canvas标签</canvas> <audio'+t._ssrAttr("src",t.musicLink)+' crossOrigin="anonymous" style="display: none" data-v-3ad53f66>您的浏览器不支持audio标签</audio> '),r("transition",{attrs:{name:"list-fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],ref:"musicListBox",staticClass:"musicList"},[r("ul",{ref:"musicList"},t._l(t.music,function(e,n){return r("li",{key:e._id,on:{click:function(e){return t.selectMusic(n)}}},[t._v(t._s(e.title)+"("+t._s(e.name)+")")])}),0),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.showlyricScroll,expression:"showlyricScroll"}],staticClass:"lyricScroll"},[r("div",{ref:"lyricScrollBar",staticClass:"lyricScrollBar",class:t.isScrolling?"active":""})])])])],2)},[],!1,function(t){var e=r(54);e.__inject__&&e.__inject__(t)},"3ad53f66","6ca28e9e");e.default=component.exports}};
//# sourceMappingURL=d759cdbf3c68b0229bc0.js.map